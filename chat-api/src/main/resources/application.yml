spring:
  application:
    name: netcourier-chat-api
  main:
    web-application-type: reactive
  datasource:
    url: ${CHATBOT_DATABASE_URL:jdbc:postgresql://localhost:5432/chatbot}
    username: ${CHATBOT_DATABASE_USERNAME:chatbot}
    password: ${CHATBOT_DATABASE_PASSWORD:chatbot}
    driver-class-name: org.postgresql.Driver
  sql:
    init:
      mode: always
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        format_sql: true
        jdbc:
          lob:
            non_contextual_creation: true
  jackson:
    serialization:
      indent-output: true
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
chat:
  rag:
    dense:
      top-k: 8
      weight: 0.6
    sparse:
      top-k: 8
      weight: 0.4
  qdrant:
    base-url: http://localhost:6333
    collection: nc_chunks_prod
    vector-name: tenant_dense_v1
    filters:
      tenant-field: tenantId
      role-field: roles
  opensearch:
    base-url: http://localhost:9200
    index: nc_chunks_prod
    tenant-field: tenantId
    roles-field: roles
  netcourier:
    base-url: http://localhost:8085
    reschedule-path: /jobs/reschedule
    track-path: /jobs/track
    ticket-path: /tickets
  embeddings:
    base-url: http://localhost:9000
  llm:
    base-url: http://localhost:1234
    api-key: ${CHAT_LLM_API_KEY:dev-token}
    model: netcourier-llama-3.1
    temperature: 0.35
    max-output-tokens: 1500
    timeout-seconds: 60
  intent:
    fallback: RAG_FAQ
    llm:
      enabled: true
      threshold: 0.55
      model: ${chat.llm.model}
      temperature: 0.0
      max-output-tokens: 384
  ingest:
    chunk-size: 800
    overlap: 200
    default-roles: CP,BO
    ocr:
      enabled: true
      language: eng
  orchestration:
    max-context-tokens: 2048
    max-citations: 5
